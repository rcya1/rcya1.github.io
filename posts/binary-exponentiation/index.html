<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Binary Exponentiation" /><meta property="og:locale" content="en_US" /><meta name="description" content="Typical Exponentiation" /><meta property="og:description" content="Typical Exponentiation" /><link rel="canonical" href="https://ryan10145.github.io/posts/binary-exponentiation/" /><meta property="og:url" content="https://ryan10145.github.io/posts/binary-exponentiation/" /><meta property="og:site_name" content="Ryan Chang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-19T11:00:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Binary Exponentiation" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"datePublished":"2021-04-19T11:00:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ryan10145.github.io/posts/binary-exponentiation/"},"description":"Typical Exponentiation","url":"https://ryan10145.github.io/posts/binary-exponentiation/","@type":"BlogPosting","headline":"Binary Exponentiation","dateModified":"2021-04-19T11:00:00-04:00","@context":"https://schema.org"}</script><title>Binary Exponentiation | Ryan Chang</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/8119928?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ryan Chang</a></div><div class="site-subtitle font-italic">High school senior going to MIT this fall to study computer science</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ryan10145" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['chang.ryan10145','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Binary Exponentiation</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Binary Exponentiation</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Ryan Chang </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 19, 2021, 11:00 AM -0400" prep="on" > Apr 19 <i class="unloaded">2021-04-19T11:00:00-04:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2116 words">11 min</span></div></div><div class="post-content"><h2 id="typical-exponentiation">Typical Exponentiation</h2><p>Let’s say you wanted to calculate the large power of a number modulo another, such as</p>\[7^{39} \pmod{1000}\]<p>The most naive way to do this would be to literally multiply $7$ by itself $39$ times and then take the remainder when divided by $1000$, aka the last $3$ digits. However, this technique quickly becomes unmanageable, especially since $7^{39}$ has $32$ digits, which would lead to a lot of work and the opportunity to make a lot of mistakes. Instead, we could work smarter, not harder.</p><p>The next way we could augment this process is by realizing that after each successive multiplication, we could take the intermediate product modulo $1000$. For instance, we would first have $7, 7^2 = 49, 7^3 = 343$. After this, we would have $7^4 = 2401$, but we can ignore everything but the last $3$ digits and simply take the $401$ as our product moving forward. By continuing this strategy, we will constantly stay with small numbers and not have to deal with $32$ digit monstrosities. However, this still involves us doing $38$ multiplications to get from $7$ to $7^{39}$. As the exponent grows even larger, it would become infeasible for humans to do it by hand.</p><p>While computers can solve these problems easily, even computers have their limitations. If the computer has to do thousands of these calculations and take powers that go up to the hundreds of millions, this strategy quickly grows infeasible as well.</p><p>However, there is a solution that can drastically speed up this calculation for large numbers known as <strong>binary exponentiation</strong>. Binary exponentiation takes advantage of the fact that we can <strong>square</strong> numbers in a single operation by simply multiplying it with itself, which doubles the exponent.</p><h2 id="applying-squaring">Applying Squaring</h2><p>Let’s say that the power we wanted to calculate was $7^8$. While we could multiply $7$ with itself $8$ times, let’s use squaring. We can first calculate $7^2 = 49$. Then, rather than multiplying $49$ by $7$ twice, we can instead square $7^2 = 49$ in a single operation to get \(7^4 = \left(7^2\right)^2 = 49^2 = 2401\)</p><p>Finally, we can square this number to get \(7^8 = \left(7^4\right)^2 = 2401^2 = 5764801\)</p><p>By using squaring, we were able to reduce our multiplication from $8$ steps to only $3$. While one may say that this may have made the operation harder since we had to square very large numbers, if we had even larger exponents and were also taking the values modulo something, the benefits of this method quickly become apparent as the number of multiplications required would actually be logarithmic when compared to the exponent. Going all the way up to something like the $1024$th exponent would only require $10$ operations, compared to the $1023$ from before.</p><p>However, this very simple trick only works at the moment with exponents that are powers of $2$. However, this is where the <strong>binary</strong> part of binary exponentiation comes in.</p><h2 id="binary">Binary</h2><p>If you aren’t familiar with the concept of other number bases, please look at <a href="https://betterexplained.com/articles/numbers-and-bases/">this explanation from Better Explained</a> that covers it well.</p><p>Now that you are familiar with number bases, binary is another word for base $2$, where each digit in a number can be either $0$ or $1$ and represents a power of $2$. You may have heard about binary in other contexts such as describing things that only have $2$ options or with computers since binary is used to represent all numbers for a computer.</p><p>Let’s look at a few examples to make sure we are comfortable with binary, but feel free to skip to the next section if you are already comfortable.</p><blockquote class="blockquote-example"><hr /> Express the binary number $111011$ in base $10$. We can do this by looking at each digit from right to left and using those to see which powers of $2$ are present in our number. Since the first two digits on the right are both $1$s, we know that $2^0$ and $2^1$ are present in our number. Since the third digit is a $0$, $2^2$ is not. However, the next three are, so the total sum would be $$2^0 + 2^1 + 2^3 + 2^4 + 2^5 = \boxed{52}$$</blockquote><blockquote class="blockquote-example"><hr /> Express the number $37$ in binary. We can do this by first looking for the largest power of $2$ present in $37$. The powers of $2$ are $1, 2, 4, 8, 16, 32, 64, ...$ Since $32 &lt; 37$ but $64 &gt; 37$, we know that $32$ is the largest power of $2$ present. We can keep note that $32 = 2^5$ is present in the number and move on by subtracting $32$ from $37$. We are left with $5$ and we have to now find the largest power of $2$ present in that. The answer is $4 = 2^2$, and after subtracting that we are left with $1 = 2^0$. We know that the powers of $2$ present are $0, 2, 5$, which corresponds to the number $100101$, since all of the correct powers of $2$ are represented there.</blockquote><h2 id="full-binary-exponentiation">Full Binary Exponentiation</h2><p>Now that we have a grasp on binary, we can move on to what exactly binary exponentiation is. The idea behind the technique is that we can break up the exponent into its binary representation and then use those corresponding powers of $2$s in our calculation. For instance, let’s say we wanted to calculate the following:</p>\[3^{37}\]<p>We can first express our exponent, $37$, in binary, or as sums of powers of $2$. We can quickly get that it is</p>\[37 = 32 + 4 + 1 = 2^5 + 2^2 + 2^0\]<p>We can then plug this representation back into our original equation to obtain:</p>\[3^{2^5 + 2^2 + 2^0}\]<p>Rewriting this with laws of exponents, we obtain the following result:</p>\[3^{37} = 3^{2^0} * 3^{2^2} * 3^{2^5}\]<p>However, remember what we said before about exponents that were powers of $2$. We can apply squaring to easily calculate all of those powers required in just $5$ operations. Then, we can simply multiply together the results to obtain the final answer in much less than $37$ operations.</p><p><strong>Calculating the Powers</strong></p>\[\begin{aligned} 3^{2^0} &amp;= 3 \\ 3^{2^1} &amp;= 3^2 = 9 \\ 3^{2^2} &amp;= 9^2 = 81 \\ 3^{2^3} &amp;= 81^2 = 6561 \\ 3^{2^4} &amp;= 6561^2 = 43046721 \\ 3^{2^5} &amp;= 43046721^2 = 1853020188851841 \end{aligned}\]<p><strong>Final Result</strong></p>\[3^{37} = 3^{2^0} * 3^{2^2} * 3^{2^5} = 3 * 81 * 1853020188851841 = \boxed{450283905890997363}\]<p>Since those numbers were huge, a more reasonable calculation might be to instead calculate</p>\[3^{37} \pmod{1000}\]<p>This could be done the mostly the same way, but you have to instead take each intermediate result mod $1000$.</p><p><strong>Calculating the Powers</strong></p>\[\begin{aligned} 3^{2^0} &amp;= 3 \\ 3^{2^1} &amp;= 3^2 = 9 \\ 3^{2^2} &amp;= 9^2 = 81 \\ 3^{2^3} &amp;= 81^2 = 6561 \rightarrow 561 \\ 3^{2^4} &amp;= 561^2 = 314721 \rightarrow 721 \\ 3^{2^5} &amp;= 721^2 = 519841 \rightarrow 841 \end{aligned}\]<p><strong>Final Result</strong></p>\[3^{37} = 3^{2^0} * 3^{2^2} * 3^{2^5} = 3 * 81 * 841 = 204363 \rightarrow \boxed{363}\]<p>And that’s pretty much the entire method! Next up, we’ll go over the advantages of this algorithm and then some of the applications for such huge exponents.</p><h2 id="big-o-notation">Big O Notation</h2><p>For those not comfortable with big O notation from computer science, feel free to skip this section. But for those interested, it is essentially a measure of how the number of operations required in a calculation scale as the input size $N$ changes. Check out <a href="https://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/">this article</a> for more details if you’re interested. It’s a topic that is very important for analyzing the runtime of computer algorithms, but its core ideas can be applied in other subject areas.</p><p>For those who know what it is, you may have realized that the naive algorithm for calculating exponents runs in $O(N)$ linear time. However, the binary exponentiation method runs in $O(\log_2(N))$ time, which is a massive improvement as $N$ increases. This is because the number of digits in the binary representation of a number is approximately equal to $\log_2(N)$.</p><h2 id="advantage-over-naive-method">Advantage Over Naive Method</h2><p>One could appreciate the significant advantages of using this algorithm when calculating something like \(7^{1000000}\)</p><p>The naive method would require around $1000000$ operations since you would have to multiply by $7$ that many times. However, the binary representation of $1000000$ is $11110100001001000000$, which is only $20$ digits long. This means that you would have to calculate only $20$ powers of $7$ (with two of them being $7^0$ and $7^1$). Then, you would only need to multiply $7$ of those numbers, which would correspond to the $1$s in the binary representation. This totals only $27$ operations compared to the almost $1000000$ from before.</p><h2 id="applications">Applications</h2><h3 id="modular-inverses">Modular Inverses</h3><p>The first application is for calculating <strong>modular inverses</strong>. In the short future, I’ll add a post that goes over this topic in depth, but essentially there’s a formula that allows you to calculate the modular inverse of a number $a$ mod $n$.</p>\[a^{\phi(n) - 1} \pmod{n}\]<p>For extremely large $n$, especially when $n$ is prime, binary exponentiation is almost a necessity to do the operations with enough speed.</p><h3 id="fibonacci-relation">Fibonacci Relation</h3><p>However, this idea of binary exponentiation does not just apply to numbers; it can also be applied to ideas like matrices. For instance, it can even be used to calculate the Fibonacci numbers! If you’re not familiar with matrices, and how they can be multiplied or used to represent linear systems, I would highly recommend checking it out since they can be really cool.</p><p>For those unfamiliar with the Fibonacci numbers, they are a sequence of integers such that $F_n$ represents the $n$th Fibonacci numbers. We define $F_0 = 0$ and $F_1 = 1$, and then we use the recurrence relation</p>\[F_n = F_{n - 1} + F_{n - 2}\]<p>Essentialy, each next term is the sum of the previous $2$ terms. The sequence goes like this:</p>\[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, ...\]<p>We can actually express this with the following equation:</p>\[\begin{bmatrix} 0 &amp; 1 \\ 1 &amp; 1 \end{bmatrix} * \begin{bmatrix} F_n \\ F_{n+1} \end{bmatrix} = \begin{bmatrix} F_{n+1} \\ F_{n+2} \end{bmatrix}\]<p>To dissect how this matrix equation works, we can break it down into its component linear equations:</p>\[F_{n + 1} = 0 + F_{n + 1}\] \[F_{n + 2} = F_{n} + F_{n + 1}\]<p>Both of these equations perfectly describe how the Fibonacci sequence is generated, showing how the matrix equation encodes the linear recurrence present in the system. The reason why this is so powerful is that we can continuously multiply these matrices to obtain higher values in the Fibonacci sequence.</p><p>In general, we can do the following:</p>\[\begin{bmatrix} 0 &amp; 1 \\ 1 &amp; 1 \end{bmatrix}^n * \begin{bmatrix} F_0 \\ F_1 \end{bmatrix} = \begin{bmatrix} F_{n} \\ F_{n+1} \end{bmatrix}\]<p>This gives us a method using matrix exponentiation to calculate the $n + 1$th Fibonacci number. However, with the power of binary exponentiation, we can calculate this exponent quickly, making calculating something like the $1000$th Fibonacci number relatively trivial. The same process of binary exponentiation can be used making this a relatively flexible technique.</p><h2 id="conclusion">Conclusion</h2><p>Overall, binary exponentiation is a pretty powerful technique to both do hand computations quickly and to speed up computer algorithms. It can be applied to pretty much any mathematical structure that has exponentiation as well, including real numbers, complex numbers, and matrices, two of which we saw above.</p><h2 id="side-note-implementation-in-programming">Side Note: Implementation in Programming</h2><p>As a quick side note, we could do the following to implement this algorithm in code (the code is in Java, but it is easily expandable to other languages). I’m not going to go over exactly how the code works as of now, but I might add it in the future.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kt">long</span> <span class="nf">binaryExpo</span><span class="o">(</span><span class="kt">int</span> <span class="n">base</span><span class="o">,</span> <span class="kt">int</span> <span class="n">exponent</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kt">long</span> <span class="n">currPower</span> <span class="o">=</span> <span class="n">base</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span><span class="n">exponent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">exponent</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">currPower</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">currPower</span> <span class="o">=</span> <span class="n">currPower</span> <span class="o">*</span> <span class="n">base</span><span class="o">;</span>
        <span class="n">exponent</span> <span class="o">/=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>We could optimize this program with bitwise operations as following (although a good compiler would probably automatically substitute these in). This method might appear more intuitive for those familar with the binary operations utilized, since it more clearly shows how you’re analyzing each binary digit of the exponent.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kt">long</span> <span class="nf">binaryExpo</span><span class="o">(</span><span class="kt">int</span> <span class="n">base</span><span class="o">,</span> <span class="kt">int</span> <span class="n">exponent</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kt">long</span> <span class="n">currPower</span> <span class="o">=</span> <span class="n">base</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span><span class="n">exponent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">exponent</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">currPower</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">currPower</span> <span class="o">=</span> <span class="n">currPower</span> <span class="o">*</span> <span class="n">base</span><span class="o">;</span>
        <span class="n">exponent</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/math-articles/'>Math Articles</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/math/" class="post-tag no-text-decoration" >math</a> <a href="/tags/article/" class="post-tag no-text-decoration" >article</a> <a href="/tags/binary/" class="post-tag no-text-decoration" >binary</a> <a href="/tags/exponents/" class="post-tag no-text-decoration" >exponents</a> <a href="/tags/modular-arithmetic/" class="post-tag no-text-decoration" >modular arithmetic</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Binary Exponentiation - Ryan Chang&url=https://ryan10145.github.io/posts/binary-exponentiation/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Binary Exponentiation - Ryan Chang&u=https://ryan10145.github.io/posts/binary-exponentiation/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Binary Exponentiation - Ryan Chang&url=https://ryan10145.github.io/posts/binary-exponentiation/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div>--- ---<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Updates</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/roots-of-unity-filter/">Roots of Unity Filter Part 3 - Roots of Unity Filter</a><li><a href="/posts/amc-wrapped/">Four Years of AMC, Wrapped</a><li><a href="/posts/roots-of-unity/">Roots of Unity Filter Part 2 - Roots of Unity</a><li><a href="/posts/complex-numbers/">Roots of Unity Filter Part 1 - Complex Numbers</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/modular-inverses/"><div class="card-body"> <span class="timeago small" > Apr 19 <i class="unloaded">2021-04-19T11:15:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Modular Inverses</h3><div class="text-muted small"><p> This post assumes a basic knowledge of modular arithmetic and the notation for it. In this article, we will use the following notation to denote $b$ as the remainder when $a$ is divided by $n$. ...</p></div></div></a></div><div class="card"> <a href="/posts/complex-numbers/"><div class="card-body"> <span class="timeago small" > Apr 18 <i class="unloaded">2021-04-18T14:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Roots of Unity Filter Part 1 - Complex Numbers</h3><div class="text-muted small"><p> Note This is a three part series I wrote back in 2019 on a technique applicable to certain competitive math problems: roots of unity filters. The first two parts are just a recap of complex number...</p></div></div></a></div><div class="card"> <a href="/posts/roots-of-unity/"><div class="card-body"> <span class="timeago small" > Apr 18 <i class="unloaded">2021-04-18T15:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Roots of Unity Filter Part 2 - Roots of Unity</h3><div class="text-muted small"><p> Note This is a three part series I wrote back in 2019 on a technique applicable to certain competitive math problems: roots of unity filters. The first two parts are just a recap of complex number...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/roots-of-unity-filter/" class="btn btn-outline-primary" prompt="Older"><p>Roots of Unity Filter Part 3 - Roots of Unity Filter</p></a> <a href="/posts/modular-inverses/" class="btn btn-outline-primary" prompt="Newer"><p>Modular Inverses</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//ryan10145-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Binary Exponentiation'; this.page.url = 'https://ryan10145.github.io/posts/binary-exponentiation/'; this.page.identifier = '/posts/binary-exponentiation/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/ryan10145">Ryan Chang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/math/">math</a> <a class="post-tag" href="/tags/article/">article</a> <a class="post-tag" href="/tags/roots-of-unity-filter/">roots of unity filter</a> <a class="post-tag" href="/tags/roots-of-unity/">roots of unity</a> <a class="post-tag" href="/tags/exponents/">exponents</a> <a class="post-tag" href="/tags/modular-arithmetic/">modular arithmetic</a> <a class="post-tag" href="/tags/aime/">aime</a> <a class="post-tag" href="/tags/amc/">amc</a> <a class="post-tag" href="/tags/binary/">binary</a> <a class="post-tag" href="/tags/blog/">blog</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ryan10145.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
